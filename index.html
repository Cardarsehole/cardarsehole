<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Presidents and Arsehole Card Game Scorer</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    h1 { text-align: center; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    button { margin: 5px; padding: 8px 12px; }
    .player-input { margin: 5px 0; }
    #history { margin-top: 30px; }
    .history-entry { border-bottom: 1px solid #ccc; padding: 5px 0; }
    .history-header { cursor: pointer; background: #f0f0f0; padding: 5px; }
    .history-details { display: none; margin-left: 10px; }
    .ad-container { margin: 20px auto; text-align: center; }
  </style>
</head>
<body>
  <h1>Presidents and Arsehole Card Game Scorer</h1>

  <div id="player-setup">
    <h3>Players</h3>
    <div id="player-list"></div>
    <button onclick="addPlayer()">Add Player</button>
    <button onclick="startGame()">Start Game</button>
  </div>

  <div id="game-section" style="display:none;">
    <button onclick="resetGame()" style="background-color:red; color:white;">Reset Game</button>
    <h3>Assign Positions</h3>
    <form id="round-form"></form>
    <button onclick="addRound()">Add Round</button>
    <h3>Total Games Played: <span id="game-count">0</span></h3>
    <table id="scoreboard">
      <thead>
        <tr><th>Player</th><th>Score</th></tr>
      </thead>
      <tbody></tbody>
    </table>

    <div id="history">
      <h3>Game History</h3>
      <div id="history-log"></div>
    </div>

    <!-- âœ… Google AdSense ad unit at the bottom -->
    <div class="ad-container">
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-pub-8460279361151582"
           data-ad-slot="1234567890"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
      <script>
           (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>

  </div>

  <script>
    let players = [];
    let scores = {};
    let gameCount = 0;
    let history = [];

    function addPlayer(name="") {
      const div = document.createElement("div");
      div.className = "player-input";
      div.innerHTML = `<input type="text" placeholder="Player name" value="${name}"> 
                       <button onclick="this.parentElement.remove()">Remove</button>`;
      document.getElementById("player-list").appendChild(div);
    }

    function startGame() {
      players = Array.from(document.querySelectorAll("#player-list input"))
        .map(i => i.value.trim()).filter(v => v);
      if (players.length < 4) {
        alert("Need at least 4 players");
        return;
      }
      scores = {};
      players.forEach(p => scores[p] = 0);
      history = [];
      gameCount = 0;
      document.getElementById("player-setup").style.display = "none";
      document.getElementById("game-section").style.display = "block";
      renderRoundForm();
      updateScoreboard();
      updateHistory();
    }

    function renderRoundForm() {
      const form = document.getElementById("round-form");
      form.innerHTML = "";
      let positions = [];
      if (players.length === 4) {
        positions = ["President", "Vice President", "Scrotum", "Arsehole"];
      } else {
        positions = ["President", "Vice President"];
        for (let i = 0; i < players.length - 4; i++) {
          positions.push("Neutral");
        }
        positions.push("Scrotum", "Arsehole");
      }

      positions.forEach(pos => {
        const select = document.createElement("select");
        players.forEach(p => {
          const opt = document.createElement("option");
          opt.value = p;
          opt.textContent = p;
          select.appendChild(opt);
        });
        form.appendChild(document.createTextNode(pos + ": "));
        form.appendChild(select);
        form.appendChild(document.createElement("br"));
      });
    }

    function addRound() {
      const selects = document.querySelectorAll("#round-form select");
      let chosen = new Set();
      for (let sel of selects) {
        if (chosen.has(sel.value)) {
          alert("Each player can only hold one position per round");
          return;
        }
        chosen.add(sel.value);
      }

      let roundLog = { roles: {}, points: {} };

      if (players.length === 4) {
        const points = { "President": 4, "Vice President": 3, "Scrotum": 2, "Arsehole": 1 };
        document.querySelectorAll("#round-form select").forEach((sel, idx) => {
          const role = ["President","Vice President","Scrotum","Arsehole"][idx];
          scores[sel.value] += points[role];
          roundLog.roles[role] = sel.value;
          roundLog.points[sel.value] = points[role];
        });
      } else {
        const points = { "President": 5, "Vice President": 4, "Neutral": 3, "Scrotum": 2, "Arsehole": 1 };
        document.querySelectorAll("#round-form select").forEach((sel) => {
          let role = sel.previousSibling.textContent.replace(": ","");
          scores[sel.value] += points[role];
          roundLog.roles[role] = sel.value;
          roundLog.points[sel.value] = points[role];
        });
      }

      gameCount++;
      document.getElementById("game-count").textContent = gameCount;
      history.push(roundLog);
      updateScoreboard();
      updateHistory();
    }

    function updateScoreboard() {
      const tbody = document.querySelector("#scoreboard tbody");
      tbody.innerHTML = "";
      players.forEach(p => {
        const row = document.createElement("tr");
        row.innerHTML = `<td>${p}</td><td>${scores[p]}</td>`;
        tbody.appendChild(row);
      });
    }

    function updateHistory() {
      const logDiv = document.getElementById("history-log");
      logDiv.innerHTML = "";
      history.forEach((round, i) => {
        const div = document.createElement("div");
        div.className = "history-entry";

        const header = document.createElement("div");
        header.className = "history-header";
        header.innerHTML = `<strong>Game ${i+1}</strong> (tap to expand)`;
        header.onclick = function() {
          details.style.display = details.style.display === "none" ? "block" : "none";
        };

        const details = document.createElement("div");
        details.className = "history-details";
        let html = "";
        for (let role in round.roles) {
          const player = round.roles[role];
          const pts = round.points[player];
          html += `${role}: ${player} (+${pts})<br>`;
        }
        details.innerHTML = html;

        div.appendChild(header);
        div.appendChild(details);
        logDiv.appendChild(div);
      });
    }

    function resetGame() {
      if (!confirm("Are you sure you want to reset the game?")) return;
      scores = {};
      players.forEach(p => scores[p] = 0);
      gameCount = 0;
      history = [];
      document.getElementById("game-count").textContent = 0;
      updateScoreboard();
      updateHistory();
    }
  </script>
</body>
</html>
